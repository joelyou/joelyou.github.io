---
title: 设计模式之命令模式 原理分析一
date: 2018-07-22 11:29:42
tags: 设计模式
---

### 命令模式的概述
命令模式是行为模式的一种，在各大语言中也经常会被运用到框架的设计当中；

1. 将一个请求封装到一个对象当中，从而让用户使用不同的请求将客户端参数化
2. 对请求排队或者记录请求日志，以及支持撤销操作
优点：降低耦合度，程序扩展性更好

### 命令模式应用场景
当需要将方法调用包装成一个对象，以及延时方法调用，或者让其他组件在对其内部实现细节不了解的情况下进行调用的时候可以使用命令模式

* 场景一：应用程序支持撤销和恢复
* 场景二：记录请求日志，当系统故障时这些命令可以重新被执行
* 场景三：想用对象参数化一个动作以执行操作，并且用不同的命令对抗来替换回调函数

### 学习框架模式的基本方法
1. 基本概念的了解
2. 分析角色，每一种设计模式里面都会有角色划分，不同场景下角色不同，有时一个类可能担当多个角色
3. 分析单个角色类结构
4. 分析单个角色意义（如子类意义所在）
5. 分析模块
6. 最后分析性能优化

### 以命令模式来分析
命令模式一般来说有4个角色存在
角色一：接收者
角色二：命令接口
角色三：具体命令
角色四：请求者

搭建这个角色的类结构，命令模式的规范

1. 角色一: 接收者->Receiver
2. 角色二: 命令接口->CommandProtocol(协议) java->接口
3. 角色三: 具体命令->ConcreateCommand
4. 角色四: 请求者->Invoker manager

### 案例分析
案列一:电脑关机和开机？

1. 创建命令接口CommandProtocol
![](/img/15322263250288.jpg)
2. 具体命令，实现类
    - 开机命令、关机命令
    - 开机：MacStartUpCommand（遵循我们的协议）
    - 关机: MacShutDownCommand（同样遵循我们的协议）
3.接收者-电脑-MacComputer
4.请求者-Invoker 面向协议编程-将所有功能抽象为协议


![](/img/15322269801928.jpg)
![](/img/15322269959938.jpg)

![](/img/15322272652785.jpg)

![](/img/15322273106137.jpg)

关机的命令也差不多
然后就是请求者
![](/img/15322288078805.jpg)
![](/img/15322288322518.jpg)

调用：
![](/img/15322288491181.jpg)


案列二：俄罗斯方块，魂斗罗 参考：[https://www.jianshu.com/p/90c4236dc3ec](https://www.jianshu.com/p/90c4236dc3ec)

